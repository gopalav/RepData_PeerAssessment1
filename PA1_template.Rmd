---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r}
# load the required data table, lattice libraries
library (data.table)
library (lattice)
# unzip the data file and read the data
unzipData <- unz('activity.zip', 'activity.csv')
activityData <- read.table(unzipData, header = TRUE, sep = ',')
# convert the data into data table
activityData <- data.table(activityData)
# process the data to create date frame with the total steps group by date
dataSummary <- as.data.frame(activityData[, j=list(total = sum(steps, na.rm = TRUE)),by = date])

```


## What is mean total number of steps taken per day?
```{r}
#calculate the mean and median of the total steps per day
meanSteps <- as.integer(mean(dataSummary$total))
medianSteps <- median(dataSummary$total)
# histogram of total steps per day
hist(dataSummary$total, xlab='Total Steps', ylab='Frequency', main='Histogram of total steps per day')
```

- **Mean total number of steps taken per day (rounded to integer) = `r meanSteps`**
- **Median total number of steps taken per day = `r medianSteps`**

## What is the average daily activity pattern?
```{r}
# process the original data to create date frame with the total steps group by interval and the mean
dataSummaryDailyPattern <- as.data.frame(activityData[, j=list(total = sum(steps, na.rm = TRUE), mean = as.integer(mean(steps, na.rm = TRUE))),by = interval])

# Calculate the interval which has the maximum number of steps
maxMean <-(max(dataSummaryDailyPattern$mean, na.rm=TRUE))
maxInterval <-with(dataSummaryDailyPattern, interval[mean == maxMean])
maxInterval <- sprintf("%04d", maxInterval)
maxInterval <- format(strptime(maxInterval, format="%H%M"), format = "%H:%M")

# plot the time series for the interval and mean
plot(dataSummaryDailyPattern$interval, dataSummaryDailyPattern$mean, type='l', xlab = 'Interval', ylab = 'Average steps', main = 'Daily Activity Pattern')
```

- **Interval which has the maximum number of steps = `r maxInterval`**

## Imputing missing values
```{r}
# Calculate the total number of NA values in the original data table
totalNA <- sum(is.na(activityData$steps))
# Copy the original dataset
activityDataWithoutNA <- activityData
# Iterate through all the intervals and replace NA values
for (i in 1:nrow(dataSummaryDailyPattern)) {
    activityDataWithoutNA$steps[is.na(activityDataWithoutNA$steps) & activityDataWithoutNA$interval==dataSummaryDailyPattern[i,]$interval] <- dataSummaryDailyPattern[i,]$mean
}
# Create a data frame for the new data set
dataSummaryWithoutNA <- as.data.frame(activityDataWithoutNA[, j=list(total = sum(steps, na.rm = TRUE)),by = date])
#calculate the mean and median of the total steps per day
meanStepsWithoutNA <- as.integer(mean(dataSummaryWithoutNA$total))
medianStepsWithoutNA <- median(dataSummaryWithoutNA$total)
```

- **Strategy for filling the missing values**
    - Replace the missing values with the mean value for that interval across all days
    - Iterate through each interval and replace all the NA values for that interval in the main data set
    - Calculate the mean and median again
- **Total number of missing values in the data set = `r totalNA`**
- **Mean total number of steps taken per day, after replacing NA values (rounded to integer) = `r meanStepsWithoutNA`**
- **Median total number of steps taken per day, after replacing NA values = `r medianStepsWithoutNA`**
- **Impact of imputting missing data:**
    - Mean increased from 9354 to 10749
    - Median increased from 10395 to 10641

```{r}
# histogram of total steps per day
hist(dataSummaryWithoutNA$total, xlab='Total Steps', ylab='Frequency', main='Histogram of total steps per day without NA values')
```

## Are there differences in activity patterns between weekdays and weekends?
```{r}
# Adding factor variable to store week day or weekend
activityDataWithoutNA$Weekday <- as.factor(ifelse(weekdays(as.Date(activityDataWithoutNA$date),abbreviate = FALSE) %in% c("Saturday","Sunday"), "Weekend", "Weekday")) 

# calculating the weekday daily pattern for each interval
activityDataWeekDay <- activityDataWithoutNA[activityDataWithoutNA$Weekday=='Weekday']
weekdayDailyPattern <- as.data.frame(activityDataWeekDay[, j=list(total = sum(steps, na.rm = TRUE), mean = as.integer(mean(steps, na.rm = TRUE))),by = interval])

# calculating the weekend daily pattern for each interval
activityDataWeekEnd <- activityDataWithoutNA[activityDataWithoutNA$Weekday=='Weekend']
weekendDailyPattern <- as.data.frame(activityDataWeekEnd[, j=list(total = sum(steps, na.rm = TRUE), mean = as.integer(mean(steps, na.rm = TRUE))),by = interval])

# plotting weekday and weekend patterns
plot(weekdayDailyPattern$interval, weekdayDailyPattern$mean, type='l', xlab = 'Interval', ylab = 'Average steps', main = 'Weekday Daily Activity Pattern')
plot(weekendDailyPattern$interval, weekendDailyPattern$mean, type='l', xlab = 'Interval', ylab = 'Average steps', main = 'Weekend Daily Activity Pattern')

```
